<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div>
    <h2 class="center">

        <a id="ctl00_cContent_fvResults_Hyperlink5" class="button bookmarklet"
           onclick="window.alert('Drag this link to your bookmarks toolbar...');return false;"
           href="javascript:(function() { var current='other page'; if(window.location.href.match('https://tp.m-team.cc/adult.php')) current='https://tp.m-team.cc/adult.php?inclbookmarked=0&incldead=1&spstate=0&&sort=5&type=asc&page=0'; if(window.location.href.match('https://tp.m-team.cc/torrents.php')) current='https://tp.m-team.cc/torrents.php?inclbookmarked=0&incldead=1&spstate=0&&sort=5&type=asc&page=0'; if(current=='other page'){ alert('请在MT种子页面或成人页面点击使用'); }else{ var j=2; var pages=100; var count=1000; var size=400; var sizeflag=false; var pageflag=false; var countflag=false; var p=1; var c=0; var shutdown=false; size=prompt('下载所有大小小于 X MB的种子'); size=parseInt(size); sizeflag=true; if(isNaN(size)){ sizeflag=false; } if(size < 0){ sizeflag=false; } console.log(sizeflag); console.log(size); if(!sizeflag){ count=prompt('总共下载多少个种子'); count=parseInt(count); countflag=true; if(isNaN(count)){ countflag=false; } if(count < 0){ countflag=false; } } console.log(sizeflag); console.log(size); if(!(countflag||sizeflag)){ pages=prompt('总共下载多少页种子'); pages=parseInt(pages); pageflag=true; if(isNaN(pages)){ pageflag=false; console.log('nan?'); } if(pages < 0){ pageflag=false; console.log('<0?'); } } if((pageflag||countflag||sizeflag)) { fr4me='<head><script src=\'https://code.jquery.com/jquery-2.1.1.min.js\' type=\'text/javascript\'></script></head>\n'; fr4me+='<frameset cols=\'63%,37%\'>\n'; fr4me+='<frame name = dealing src=\''+current+'\'/>'; fr4me+='<frame name = funcing />'; fr4me+='</frameset>'; with(document){write(fr4me);void(close());}; (function(){var s=document.createElement('script');s.setAttribute('src','https://code.jquery.com/jquery-2.1.1.min.js');s.setAttribute('type','text/javascript');document.getElementsByTagName('head')[0].appendChild(s);jQuery.noConflict();})(); testing(); } function testing(){ try{ console.log('testing'); e = $(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child(100) > td:nth-child(9)')[0].outerText; console.log(e); setTimeout(function(){working();},100); } catch(err){ setTimeout(function(){testing();},500); console.log('%E6%9C%AA%E5%AE%8C%E6%88%90'); } } function working(){ for( j=2;j<102;j++){ console.log('%E5%87%86%E5%A4%87%E7%BD%AE%E9%A1%B6'); var sticky=$(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child('+j+') > td.torrenttr > table > tbody > tr')[0].className; console.log('%E5%87%86%E5%A4%87%E7%BD%AE%E9%A1%B6s'); console.log(j); console.log(sticky); if(sticky.length == 0){ console.log('%E5%A4%A7%E5%B0%8F'); sizeHTML = $(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child('+j+')> td:nth-child(5)')[0].outerHTML; tail=sizeHTML.indexOf('<br>'); head=sizeHTML.indexOf('>'); console.log('%E5%87%86%E5%A4%87%E5%A4%A7%E5%B0%8F'); var fsize = sizeHTML.slice(head+1,tail); if(!sizeflag||(sizeHTML.search('<br>KB</td>')>0||(sizeHTML.search('<br>MB</td>')>0&&fsize<size))){ var flag=$(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child('+j+') > td:nth-child(9)')[0].outerText; console.log('%E5%87%86%E5%A4%87%E8%BF%9B%E5%BA%A6'); if(flag!='--'&&flag!='0.0%'){ console.log('skip '+j); } else { console.log('down '+c++); if(countflag&&c>count){ console.log('%E6%80%BB%E6%95%B0%E5%AE%8C%E6%88%90'); shutdown=true; break; } var downurl=$(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child('+j+') > td.torrenttr > table > tbody > tr > td:nth-child(3) > a:nth-child(1)')[0].href; var elemIF = window.frames['funcing'].document.createElement('iframe'); elemIF.src = downurl; elemIF.style.display = 'none'; window.frames['funcing'].document.body.appendChild(elemIF); } }else{ console.log(fsize); console.log(size); console.log(fsize<size); shutdown=true; console.log('%E5%A4%A7%E5%B0%8F%E5%AE%8C%E6%88%90'); break; } } } if(pageflag&&++p>pages) { shutdown=true; } console.log(shutdown); if(!shutdown){ var pageurl=$(window.frames['dealing'].document).find('#outer > table > tbody > tr > td > p > a:nth-child(2)')[0].href; window.frames['dealing'].document.location.href=pageurl; setTimeout(function(){testing();},5000); } } } })();">
            MT批量下载

        </a>
    </h2>
</div>
<div>
    <h2 class="center">

        <a id="ctl00_cContent_fvResults_Hyperlink5" class="button bookmarklet"
           onclick="window.alert('Drag this link to your bookmarks toolbar...');return false;"
           herf="javascript: (function() { var current = 'other page'; var pageadd='?inclbookmarked=0&incldead=1&spstate=0&&sort=5&type=asc&page='; var pagenum=0; var pageset; if (window.location.href.match('https://tp.m-team.cc/adult.php')) { pageset='https://tp.m-team.cc/adult.php'; current = pageset+pageadd+pagenum; } if (window.location.href.match('https://tp.m-team.cc/torrents.php')){ pageset='https://tp.m-team.cc/torrents.php'; current = pageset+pageadd+pagenum; } if (current == 'other page') { alert('%E8%AF%B7%E5%9C%A8MT%E7%A7%8D%E5%AD%90%E9%A1%B5%E9%9D%A2%E6%88%96%E6%88%90%E4%BA%BA%E9%A1%B5%E9%9D%A2%E7%82%B9%E5%87%BB%E4%BD%BF%E7%94%A8'); } else { var j = 2; var pages = 100; var count = 1000; var size = 400; var sizeflag = false; var pageflag = false; var countflag = false; var p = 1; var c = 0; var shutdown = false; size = prompt('%E4%B8%8B%E8%BD%BD%E6%89%80%E6%9C%89%E5%A4%A7%E5%B0%8F%E5%B0%8F%E4%BA%8E X MB%E7%9A%84%E7%A7%8D%E5%AD%90'); size = parseInt(size); sizeflag = true; if (isNaN(size)) { sizeflag = false; } if (size < 0) { sizeflag = false; } console.log(sizeflag); console.log(size); if (!sizeflag) { count = prompt('%E6%80%BB%E5%85%B1%E4%B8%8B%E8%BD%BD%E5%A4%9A%E5%B0%91%E4%B8%AA%E7%A7%8D%E5%AD%90'); count = parseInt(count); countflag = true; if (isNaN(count)) { countflag = false; } if (count < 0) { countflag = false; } } console.log(sizeflag); console.log(size); if (! (countflag || sizeflag)) { pages = prompt('%E6%80%BB%E5%85%B1%E4%B8%8B%E8%BD%BD%E5%A4%9A%E5%B0%91%E9%A1%B5%E7%A7%8D%E5%AD%90'); pages = parseInt(pages); pageflag = true; if (isNaN(pages)) { pageflag = false; console.log('nan?'); } if (pages < 0) { pageflag = false; console.log('<0?'); } } if ((pageflag || countflag || sizeflag)) { fr4me = '<head><script src=\'https://code.jquery.com/jquery-2.1.1.min.js\' type=\'text/javascript\'></script></head>\n'; fr4me += '<frameset cols=\'63%,37%\'>\n'; fr4me += '<frame name = dealing src=\'' + current + '\'/>'; fr4me += '<frame name = funcing />'; fr4me += '</frameset>'; with(document) { write(fr4me); void(close()); }; (function() { var s = document.createElement('script'); s.setAttribute('src', 'https://code.jquery.com/jquery-2.1.1.min.js'); s.setAttribute('type', 'text/javascript'); document.getElementsByTagName('head')[0].appendChild(s); jQuery.noConflict(); })(); testing(); } function testing() { try { console.log('testing'); e = $(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child(101) > td:nth-child(9)')[0].outerText; console.log(e); setTimeout(function() { working(); }, 100); } catch(err) { setTimeout(function() { testing(); }, 500); console.log('%E6%9C%AA%E5%AE%8C%E6%88%90'); } } function working() { for (j = 2; j < 102; j++) { var sticky=''; if(pagenum<1){ console.log('check top'); sticky = $(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child(' + j + ') > td.torrenttr > table > tbody > tr')[0].className; } console.log('Torrent No.'+j); console.log('top status:'+sticky); if (sticky.length == 0) { console.log(''); var fsize; if(sizeflag){ sizeHTML = $(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child(' + j + ')> td:nth-child(5)')[0].outerHTML; tail = sizeHTML.indexOf('<br>'); head = sizeHTML.indexOf('>'); fsize = sizeHTML.slice(head + 1, tail); console.log('file size'+fsize); } if (!sizeflag || (sizeHTML.search('<br>KB</td>') > 0 || (sizeHTML.search('<br>MB</td>') > 0 && fsize < size))) { var peeractive = $(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child('+j+') > td:nth-child(9)')[0].className.search('peer'); var flag = $(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child(' + j + ') > td:nth-child(9)')[0].outerText; console.log('flag1 ' + flag); console.log('%E5%87%86%E5%A4%87%E8%BF%9B%E5%BA%A6'); try { console.log('checking'); flag = $(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child(' + j + ') > td:nth-child(6) > span')[0].outerText; console.log('flag2 ' + flag); console.log('no seeders'); } catch(err) { console.log('have seeders'); } if (peeractive > 0||flag == '0' || flag == '100%') { console.log('skip ' + j); } else { console.log('down ' + c++); console.log('flag go ' + flag); if (countflag && c > count) { console.log('reach count'); shutdown = true; return; } var downurl = $(window.frames['dealing'].document).find('#form_torrent > table > tbody > tr:nth-child(' + j + ') > td.torrenttr > table > tbody > tr > td:nth-child(3) > a:nth-child(1)')[0].href; var elemIF = window.frames['funcing'].document.createElement('iframe'); elemIF.src = downurl; elemIF.style.display = 'none'; window.frames['funcing'].document.body.appendChild(elemIF); } } else { console.log(fsize); console.log(size); console.log(fsize < size); shutdown = true; console.log('reach size'); return; } } } if (pageflag && ++p > pages) { shutdown = true; console.log('reach page'); } console.log(shutdown); if (!shutdown) { pagenum++; var pageurl = pageset+pageadd+pagenum; try { window.frames['dealing'].document.write(''); console.log('clear'); } catch(err) { console.log('clear fail'); } setTimeout(function() { window.frames['dealing'].document.location.href = pageurl; }, 1000); setTimeout(function() { testing(); }, 1000); } } } })();"
           >
           MT批量下载改

        </a>
    </h2>
</div>
<h3 >将上方链接拖到收藏夹，在MTeam种子页或成人页点击</h3>
<!--<a onclick="window.alert('Drag this link to your bookmarks toolbar...');return false;" href="javascript:(function(){var s=document.createElement('script');s.setAttribute('src','https://code.jquery.com/jquery-2.1.1.min.js');s.setAttribute('type','text/javascript');document.getElementsByTagName('head')[0].appendChild(s);jQuery.noConflict();})();"><span id="ctl00_cContent_fvResults_Label1">jQuerify</span><img id="ctl00_cContent_fvResults_Image1" src="http://t2.27270.com/uploads/tu/20150422/3-140S0105358.jpg" style="border-width:0px;"></a>-->
</body>
</html>
